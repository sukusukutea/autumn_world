<!DOCTYPE html>
<html>
<head>
  <title>秋の世界を育てる</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>
<body>
  <!-- ✨ データ属性でアセットパスを渡す -->
  <div class="game-page" 
       data-controller="game"
       data-game-summer-sky-value="<%= asset_path('summer/sky_summer.png') %>"
       data-game-autumn-sky-value="<%= asset_path('autumn/sky_autumn.png') %>"
       data-game-summer-trees-value="<%= asset_path('summer/trees_summer.png') %>"
       data-game-autumn-trees-value="<%= asset_path('autumn/trees_autumn.png') %>"
       data-game-summer-ground-value="<%= asset_path('summer/ground_summer.png') %>"
       data-game-autumn-ground-value="<%= asset_path('autumn/ground_autumn.png') %>"
       data-game-summer-cloud-value="<%= asset_path('summer/cloud_summer.png') %>"
       data-game-autumn-cloud-value="<%= asset_path('autumn/cloud_autumn.png') %>"
       data-game-summer-mountain-value="<%= asset_path('summer/mountain_summer.png') %>"
       data-game-autumn-mountain-value="<%= asset_path('autumn/mountain_autumn.png') %>"
       data-game-summer-grandma-value="<%= asset_path('summer/grandma_summer.png') %>"
       data-game-autumn-grandma-value="<%= asset_path('autumn/grandma_autumn.png') %>"
       data-game-autumn-persimmon-value="<%= asset_path('autumn/persimmon.png') %>">
    
    <div class="game-field">
      <!-- 空レイヤー -->
      <div class="layer sky-layer">
        <%= image_tag('summer/sky_summer.png',
            class: "layer-image",
            id: "sky-image",
            data: { game_target: "sky" }) %>
      </div>

      <!-- 雲レイヤー -->
      <div class="layer cloud-layer">
        <%= image_tag('summer/cloud_summer.png',
            class: "layer-image",
            id: "cloud-image",
            data: { game_target: "cloud" }) %>
      </div>

      <!-- 山レイヤー -->
      <div class="layer mountain-layer">
        <%= image_tag('summer/mountain_summer.png',
            class: "layer-image",
            id: "mountain-image",
            data: { game_target: "mountain" }) %>
      </div>
      
      <!-- 木々レイヤー -->
      <div class="layer trees-layer">
        <%= image_tag('summer/trees_summer.png',
            class: "layer-image",
            id: "trees-image",
            data: { game_target: "trees" }) %>
      </div>
      
      <!-- 地面レイヤー -->
      <div class="layer ground-layer">
        <%= image_tag('summer/ground_summer.png',
            class: "layer-image",
            id: "ground-image",
            data: { game_target: "ground" }) %>
      </div>

      <!-- グランマレイヤー -->
      <div class="layer grandma-layer">
        <%= image_tag('summer/grandma_summer.png',
            class: "layer-image",
            id: "grandma-image",
            data: { game_target: "grandma" }) %>
      </div>

      <!-- 柿レイヤー -->
      <div class="layer persimmon-layer" style="display: none;">
        <%= image_tag('autumn/persimmon.png',
            class: "layer-image",
            id: "persimmon-image",
            data: { game_target: "persimmon" }) %>
      </div>
    </div>
    
    <!-- メッセージ表示エリア -->
    <div class="message-area" data-game-target="message"></div>
    
    <!-- ✨ 入力エリア（form_withを使わない版） -->
    <div class="input-area">
      <div class="word-form">
        <input type="text" 
               placeholder="秋といえば？" 
               class="word-input"
               data-game-target="wordInput"
               data-action="keypress->game#handleEnter">
        
        <div class="button-group">
          <button type="button" 
                  class="transform-btn"
                  data-action="click->game#transformWorld">
            世界に反映
          </button>
          
          <%= link_to "完成", complete_path, class: "complete-btn" %>
          
          <button type="button" 
                  class="reset-btn"
                  data-action="click->game#resetWorld">
            最初に戻る
          </button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>